{% extends 'base.html' %}
{% block title %}模試情報管理{% endblock %}
{% block content %}
<article>
    <hgroup>
        <h1>模試情報管理</h1>
        <a href="{{ url_for('main.new_exam') }}" role="button">新しい模試を追加</a>
    </hgroup>
    <p>以下のボタンを押すと、各サイトから最新の模試情報を自動で取得・登録します。</p>
    <div class="grid">
        <form action="{{ url_for('main.import_exams', provider='kawai') }}" method="post" style="margin: 0;">
             <button type="submit" class="secondary outline" aria-busy="false">河合塾の模試を取得</button>
        </form>
        <form action="{{ url_for('main.import_exams', provider='sundai') }}" method="post" style="margin: 0;">
             <button type="submit" class="secondary outline" aria-busy="false">駿台の模試を取得</button>
        </form>
        <form action="{{ url_for('main.import_exams', provider='toshin') }}" method="post" style="margin: 0;">
             <button type="submit" class="secondary outline" aria-busy="false">東進の模試を取得</button>
        </form>
    </div>
    {% with messages = get_flashed_messages() %}
      {% if messages %}
        <div class="flash-messages">
          {% for message in messages %}
            <p>{{ message }}</p>
          {% endfor %}
        </div>
      {% endif %}
    {% endwith %}
    <table>
        <thead>
            <tr>
                <th>提供元</th>
                <th>模試名</th>
                <th>実施日</th>
                <th>申込締切</th>
                <th>操作</th>
            </tr>
        </thead>
        <tbody>
            {% for exam in exams %}
            <tr>
                <td>{{ exam.provider }}</td>
                <td>{{ exam.name }}</td>
                <td>{{ exam.exam_date.strftime('%Y-%m-%d') }}</td>
                <td>{{ exam.app_end_date.strftime('%Y-%m-%d') }}</td>
                <td>
                    <a href="{{ url_for('main.edit_exam', exam_id=exam.id) }}">編集</a>
                    <form action="{{ url_for('main.delete_exam', exam_id=exam.id) }}" method="post" onsubmit="return confirm('本当に削除しますか？');" style="display: inline;">
                        <button type="submit" class="secondary outline" style="padding: 2px 8px; margin-left: 1rem;">削除</button>
                    </form>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</article>
{% endblock %}